#include<stdio.h>
#include<stdlib.h>

typedef union z z;
union z
{
  char ch;
  unsigned char uc;
  signed char sc;
  short sh;
  unsigned short us;
  signed short ss;
  int in;
  unsigned int ui;
  signed int si;
  long lo;
  unsigned long lu;
  signed long ls;
  long long ll;
  unsigned long long ul;
  signed long long sl;
  float fl;
  double db;
  long double ld;
  z *y;
  z (*f0)();
  z (*f1)(z);
  z (*f2)(z,z);
  z (*f3)(z,z,z);
  z (*f4)(z,z,z,z);
  z (*f5)(z,z,z,z,z);
  z (*f6)(z,z,z,z,z,z);
  z (*f7)(z,z,z,z,z,z,z);
  z (*f8)(z,z,z,z,z,z,z,z);
  z (*f9)(z,z,z,z,z,z,z,z,z);
  z (*f10)(z,z,z,z,z,z,z,z,z,z);
  z (*f11)(z,z,z,z,z,z,z,z,z,z,z);
  z (*f12)(z,z,z,z,z,z,z,z,z,z,z,z);
  z (*f13)(z,z,z,z,z,z,z,z,z,z,z,z,z);
  z (*f14)(z,z,z,z,z,z,z,z,z,z,z,z,z,z);
  z (*f15)(z,z,z,z,z,z,z,z,z,z,z,z,z,z,z);
  z (*f16)(z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z);
  z (*f17)(z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z);
  z (*f18)(z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z);
  z (*f19)(z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z);
  z (*f20)(z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z);
};
typedef char ch;
typedef unsigned char uc;
typedef signed char sc;
typedef short sh;
typedef unsigned short us;
typedef signed short ss;
typedef int in;
typedef unsigned int ui;
typedef signed int si;
typedef long lo;
typedef unsigned long lu;
typedef signed long ls;
typedef long long ll;
typedef unsigned long long ul;
typedef signed long long sl;
typedef float fl;
typedef double db;
typedef long double ld;
typedef z *y;
typedef z (*f0)();
typedef z (*f1)(z);
typedef z (*f2)(z,z);
typedef z (*f3)(z,z,z);
typedef z (*f4)(z,z,z,z);
typedef z (*f5)(z,z,z,z,z);
typedef z (*f6)(z,z,z,z,z,z);
typedef z (*f7)(z,z,z,z,z,z,z);
typedef z (*f8)(z,z,z,z,z,z,z,z);
typedef z (*f9)(z,z,z,z,z,z,z,z,z);
typedef z (*f10)(z,z,z,z,z,z,z,z,z,z);
typedef z (*f11)(z,z,z,z,z,z,z,z,z,z,z);
typedef z (*f12)(z,z,z,z,z,z,z,z,z,z,z,z);
typedef z (*f13)(z,z,z,z,z,z,z,z,z,z,z,z,z);
typedef z (*f14)(z,z,z,z,z,z,z,z,z,z,z,z,z,z);
typedef z (*f15)(z,z,z,z,z,z,z,z,z,z,z,z,z,z,z);
typedef z (*f16)(z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z);
typedef z (*f17)(z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z);
typedef z (*f18)(z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z);
typedef z (*f19)(z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z);
typedef z (*f20)(z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z,z);
ul const block=2;

z n()
{
  z result;
  result.y=(y)malloc((block+1)*sizeof(z));
  result.y+=block;
  result.y[0].ul=0;
  return result;
}

ul e(z object)
{
  return object.y[0].ul;
}

void display(z object)
{
  printf("(%llu)",e(object));
  ul i;
  for(i=1;i<=e(object);++i)
  {
    printf("%c",object.y[i].uc);
  }
}

void displayLine(z object)
{
  display(object);
  printf("\n");
}

void displaySpace(z object)
{
  display(object);
  printf(" ");
}

z c(z object)
{
  z result;
  result.y=(y)malloc((e(object)+1)*sizeof(z));
  ul i;
  for(i=0;i<=e(object);++i)
  {
    result.y[i]=object.y[i];
  }
  return result;
}

ul size(ul extent)
{
  return (extent==0)?block:((extent-1)/block+1)*block;
}

void f(z stack)
{
  ul sz=size(e(stack));
  stack.y-=sz-e(stack);
  free(stack.y);
}

z push(z object,z stack)
{
  ul sz=size(e(stack)+1);
  if(e(stack)+block==sz)
  {
    z result;
    result.y=(y)malloc((sz+1)*sizeof(z));
    result.y+=sz-e(stack)-1;
    result.y[0].ul=e(stack)+1;
    result.y[1]=object;
    ++result.y;
    ul i;
    for(i=1;i<=e(stack);++i)
    {
     result.y[i]=stack.y[i];
    }
    --result.y;
    f(stack);
    return result;
  }
  else
  {
    --stack.y;
    stack.y[0].ul=stack.y[1].ul+1;
    stack.y[1]=object;
    return stack;
  }
}

z pop(z stack)
{
  ul sz=size(e(stack)-1);
  if(sz<e(stack))
  {
    z result;
    result.y=(y)malloc((sz+1)*sizeof(z));
    result.y[0].ul=e(stack)-1;
    ++stack.y;
    ul i;
    for(i=1;i<=e(result);++i)
    {
      result.y[i]=stack.y[i];
    }
    --stack.y;
    f(stack);
    return result;
  }
  else
  {
    stack.y[1].ul=stack.y[0].ul-1;
    ++stack.y;
    return stack;
  }
}
    
int main()
{
  z v;
  z fun;
  z stack;
  v.uc='Z';
  stack=n();
  stack=push(v,stack);
  stack=push(v,stack);
  stack=push(v,stack);
  stack=push(v,stack);
  stack=push(v,stack);
  stack=push(v,stack);
  displayLine(stack);
  stack=pop(stack);
  displayLine(stack);
  stack=pop(stack);
  displayLine(stack);
  stack=pop(stack);
  displayLine(stack);
  stack=pop(stack);
  displayLine(stack);
  stack=pop(stack);
  displayLine(stack);
  stack=pop(stack);
  displayLine(stack);
  f(stack);
  return 0;
}
